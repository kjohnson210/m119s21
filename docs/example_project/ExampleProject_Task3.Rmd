---
title: "Example Project Task 3"
author: "Math 119 Class"
date: "5/6/2021"
output: 
  html_document:
    code_folding: hide
---

```{r include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

We are interested in the variation in the measured brightness of light bulbs. We will fit three models $f_0$, $f_1$, and $f_2$ to the distribution of 202 light bulbs measured at 2104 hours after each light bulbs was turned on. The brightness of each light bulbs is measured in lumens and recorded as a percent of the original brightness of the bulb, $\left(\frac{\text{current brightness in lumens}}{\text{original brightness in lumens when the bulb was first turned on}} \right) (100)$.

```{r}
library(data4led)
dist <- led_time(2100)
x <- dist$percent_intensity

par(mfrow=c(1,1),mar=c(2,2,3,0.25),oma=rep(0.5,4))
hist(x,probability = TRUE, main="Histogram of Lightbulb Intensities \n after 2104 hours")
```



## Fitting $f_0$
We start by looking at the model $f_0(L; a,b) = \frac{1}{b-a}$ with $-\infty < a < L < b < \infty$ (and 0 otherwise). We show a poor visual fit and a good visual fit of this model to this data in the figure below. In the left plot we have the model, $f_0(L; 96, 101) = \frac{1}{5}$ with $-\infty < 96 < L < 101 < \infty$. In the right plot we have the model, $f_0(L; 99.5, 103.5) = \frac{1}{4}$ with $-\infty < 99.5 < L < 103.5 < \infty$.
```{r}
f0 <- function(L,a=0,b=1){
# Make sure a < b.

out <- rep(0,length(L))
out[(L <= a)] <- 0
out[(a < L) & (L < b)] <- 1/(b-a) + 0*L[(a < L) & (L < b)]
out[(L >=b)] <-0

return(out)
}

x <- dist$percent_intensity

L <- seq(95,105,0.01)
y1 <- f0(L,a=96,b=101)
y2 <- f0(L,a=99.5,b=103.5)


par(mfrow=c(1,2),mar=c(2.5,2.5,1,0.25),oma=rep(0.5,4))
hist(x,probability = TRUE,xlim=c(95,105),ylim=c(0,1),main="Poor Fit, f0")
lines(L,y1,col=2)

hist(x,probability = TRUE,xlim=c(95,105),ylim=c(0,1),main="Good Fit, f0")
lines(L,y2,col=2)
```

We see the model on the left is a poor visual fit to this data. This model shows that we should expect to see bulbs that are 96% of their original intensity up to 101% of their original intensity. However, we see no bulbs with intensity less than 99.5% in this data and we see bulbs with intensity greater than 101% in this data.

In comparison, the model on the right is a good visual fit to this data. This model shows we should expect to see bulbs from 99.5% to 103% of their original intensity. While some intensities happen more often than this model suggests and some intensities happen less often than this model suggests, this is a good visual fit of the general model to this data.

We have visually fit the general model, $f_0(L; a,b) = \frac{1}{b-a}$ with $-\infty < a < L < b < \infty$, to our data. The general model has no information from our data. The fitted model we have selected is $f_0(L) = \frac{1}{4}$ with $-\infty < 99.5 < L < 103.5 < \infty$. This model contains information from our data (in the parameter values we have selected). The story that this fitted model tells is that all intensities from 99.5% to 103% are equally likely and will happen with the same frequency. 



## Fitting $f_1$
Next we consider the general function $f_1(L; h,a) = \frac{1}{\sqrt{2\pi a}}e^{-\frac{(x-h)^2}{2a}}$ with $h > 0$, $a > 0$, and $-\infty < L < \infty$. We show a poor visual fit and a good visual fit of this model to this data in the figure below. In the left plot we have the model, $f_1(L; 100,0.8) = \frac{1}{\sqrt{2\pi (0.8)}}e^{-\frac{(x-100)^2}{2(0.8)}}$ with $-\infty < L < \infty$. In the right plot we have the model, $f_1(L; 101.5,0.5) = \frac{1}{\sqrt{2\pi (0.5)}}e^{-\frac{(x-101.5)^2}{2(0.5)}}$ with $-\infty < L < \infty$.
```{r}
f1 <- function(L,h=0,a=1){
#Make sure h > 0 and a > 0.
1/sqrt(2*pi*a)*exp(-(L-h)^2/(2*a))
}

x <- dist$percent_intensity

L <- seq(95,105,0.01)
y1 <- f1(L,h=100,a=0.8)
y2 <- f1(L,h=101.5,a=0.5)


par(mfrow=c(1,2),mar=c(2,2,3,0.25),oma=rep(0.5,4))
hist(x,probability = TRUE,xlim=c(95,105),ylim=c(0,1),main="Poor Fit, f1")
lines(L,y1,col=2)

hist(x,probability = TRUE,xlim=c(95,105),ylim=c(0,1),main="Good Fit, f1")
lines(L,y2,col=2)
```

We see the model on the left is a poor visual fit to this data. This model shows a peak at 100% intensity and most of the bulbs with intensity from about 97.5% to 102.5%. However, we see no bulbs with intensity less than 99.5% in this data and we see bulbs with intensity greater than 102.5% in this data. We also see most common intensities in the data are around 101-102%.

In comparison, the model on the right is a good visual fit to this data. This model shows a peak at 101.5% intensity and most of the bulbs with intensity from about 99.5% to 103.5%. This is similar to what we see in this data. This model also shows the height of the peak is bit higher than 0.6. This is similar to what we see in this data. This is a good visual fit of the general model to this data.

We have visually fit the general model, $f_1(L; h,a) = \frac{1}{\sqrt{2\pi a}}e^{-\frac{(x-h)^2}{2a}}$ with $h > 0$, $a > 0$, and $-\infty < L < \infty$, to the data provided. The general model has no information from our data. The fitted model we have selected is $f_1(L) = \frac{1}{\sqrt{2\pi (0.5)}}e^{-\frac{(x-101.5)^2}{2(0.5)}}$ with $-\infty < L < \infty$. This model contains information from our data (in the parameter values we have selected). The story that this fitted model tells is that while all intensities are possible, intensities outside 99% to 104% are very uncommon and intensities around 101.5% occuring most frequently. 


## Fitting $f_2$
Last we consider the general function $f_2(L; h,a,b) = \frac{b^a}{\Gamma(a)}(L-h)^{a-1}e^{-b(L-h)}$ with $a > 0$, $b >0$, and $L \geq h$ (and 0 otherwise). We show a poor visual fit and a good visual fit of this model to this data in the figure below. In the left plot we have the model, $f_2(L; 96,20,9) = \frac{9^{20}}{\Gamma(20)}(L-96)^{20-1}e^{-9(L-96)}$ with $L \geq 96$. In the right plot we have the model, $f_2(L; 98.45,25.8,8.5) = \frac{8.5^{25.8}}{\Gamma(25.8)}(L-98.45)^{25.8-1}e^{-8.5(L-98.45)}$ with $L \geq 98.45$.

```{r}
f2 <- function(L,h=0,a=1,b=5){
# Make sure a > 0 and b > 0.

out <- rep(-1,length(L))
out[(L < h)] <- 0*L[(L < h)]
out[(L >= h)] <- b^a/gamma(a)*(L[(L >= h)]-h)^(a-1)*exp(-b*(L[(L >= h)]-h))

return(out)
}

x <- dist$percent_intensity

L <- seq(95,105,0.01)
y1 <- f2(L,h=96,a=20,b=9)
y2 <- f2(L,h=98.45,a=25.8,b=8.5)


par(mfrow=c(1,2),mar=c(2,2,3,0.25),oma=rep(0.5,4))
hist(x,probability = TRUE,xlim=c(95,105),ylim=c(0,1),main="Poor Fit, f2")
lines(L,y1,col=2)

hist(x,probability = TRUE,xlim=c(95,105),ylim=c(0,1),main="Good Fit, f2")
lines(L,y2,col=2)
```

We see the model on the left is a poor visual fit to this data. The location and height of the peak do not match up. In comparison, the model on the right is a good visual fit to this data. The location, height, and width of the peak matches what we see in this data.

We have visually fit the general model, $f_2(L; h,a,b) = \frac{b^a}{\Gamma(a)}(L-h)^{a-1}e^{-b(L-h)}$ with $a > 0$, $b >0$, and $L \geq h$, to the data provided. The general model has no information from our data. The fitted model we have selected is $f_2(L) = \frac{8.5^{25.8}}{\Gamma(25.8)}(L-98.45)^{25.8-1}e^{-8.5(L-98.45)}$ with $L \geq 98.45$. This model contains information from our data (in the parameter values we have selected). The story that this fitted model tells is that light bulbs will only have intensities larger than 98.45% (but could have any intensity larger than this). However, we expect to intensities from 100-104% with intensities outside this range occurring very infrequently and intensities around 101.5% being most common. 