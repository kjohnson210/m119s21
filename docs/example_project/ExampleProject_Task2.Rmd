---
title: "Example Project: Parameter Exploration"
author: "Sister Johnson"
date: "5/4/2021"
output: 
  html_document:
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

We will consider the model $f_2(L; h,a,b) = \frac{b^a}{\Gamma(a)}(L-h)^{a-1}e^{-b(L-h)}$ with $a > 0$, $b > 0$ and $L \geq h$ (0 otherwise) and how changing the parameters of those models changes the output.

We set $a=26.8$ and $b=11.4$ and look at the effect of changing $h$. In the figure below, the right plot $h=92$ and in the left plot $h=100$. For this choice of parameter values, we see $f_2$ has a peak, the function is first increasing and then decreasing. Notice that $f_2$ is a piecewise function and the peak is near the left side of interval that has nonzero function values. 

```{r}
f2 <- function(L,h=0,a=1,b=5){
# Make sure a > 0 and b > 0.

out <- rep(-1,length(L))
out[(L < h)] <- 0*L[(L < h)]
out[(L >= h)] <- b^a/gamma(a)*(L[(L >= h)]-h)^(a-1)*exp(-b*(L[(L >= h)]-h))

return(out)
}

a <- 26.8
b <- 11.4
h1 <- 92
L1 <- seq(h1,120,0.1)
y1 <- f2(L1,h1,a,b)

par(mfrow=c(1,2),mar=c(2,2,2,0.25),oma=c(0.5,0.5,1,0.25))
plot(L1,y1,type='l',xlim=c(80,120),main='h=92')

h2 <- 100
L2 <- seq(h2,120,0.1)
y2 <- f2(L2,h2,a,b)

plot(L2,y2,type='l',xlim=c(80,120),main='h=100')
mtext('Changing h in f2', side = 3, line = 0, outer = TRUE)
```

As we increase $h$ the curve shifts to the right, a horizontal shift. We notice that the domain of $f_2$ depends on $h$ and the nonzero branch of $f_2$ has fewer input values as $h$ increases.


The parameters $a$ and $b$ both seem to influence the shape of the curve. As $a$ or $b$ change the location of the peak, shape of the peak, and height of the peak change. As $b$ gets larger the peak gets taller, more narrow, and moves to the right. As $b$ gets smaller the peak flattens getting shorter and wider, the peak also moves to the left. The parameter $b$ seems to be involved with stretch and compression transformations.

As $a$ gets larger the peak gets shorter and wider and moves to the right, and the curve near the peak appear more symmetric. As $a$ gets smaller the peak gets larger, more narrow, and moves to the left. The parameter $a$ seems to be involved with stretch and compression transformations. However $a$ seems to have an effect opposite or opposing the effects of $b$.

In the figure below we see how changing $b$ changes $f_2$. We set $a=15.4$ and $h=92$ and look at the effect of changing $b$. In the right plot $b=6$ and in the left plot $b=1.4$. We see that when $b$ is larger the peak is taller, more narrow, and further to the left as described above.
```{r}
a <- 15.4
b1 <- 6
h <- 92
L1 <- seq(h,120,0.1)
y1 <- f2(L1,h,a,b1)

par(mfrow=c(1,2),mar=c(2,2,2,0.25),oma=c(0.5,0.5,1,0.25))
plot(L1,y1,type='l',xlim=c(80,120),ylim=c(0,0.65),main='b=6')

b2 <- 1.4
L2 <- seq(h,120,0.1)
y2 <- f2(L2,h,a,b2)

plot(L2,y2,type='l',xlim=c(80,120),ylim=c(0,0.65),main='b=1.4')
mtext('Changing b in f2', side = 3, line = 0, outer = TRUE)
```

In the figure below we see how changing $a$ changes $f_2$. We set $b=6$ and $h=92$ and look at the effect of changing $a$. In the right plot $a=30$, in the middle plot $a=12$, and in the left plot $a=0.8$. We see that when $a$ is larger the peak is shorter, more wider, and further to the right as described above. In addition we see that when $a$ is smaller the curve is less symmetric around the peak with the left side of the curve increase more quickly the smaller $a$ is until when $a < 1$ the peak is at the left of the nonzero branch of $f_2$ and $f_2$ only decreases after the "peak".
```{r}
a1 <- 30
b <- 6
h <- 92
L1 <- seq(h,120,0.1)
y1 <- f2(L1,h,a1,b)

par(mfrow=c(1,3),mar=c(2,2,2,0.25),oma=c(0.5,0.5,1.5,0.25))
plot(L1,y1,type='l',xlim=c(80,120),ylim=c(0,0.8),main='a=30')

a2 <- 12
L2 <- seq(h,120,0.1)
y2 <- f2(L2,h,a2,b)

plot(L2,y2,type='l',xlim=c(80,120),ylim=c(0,0.8),main='a=12')

a3 <- 0.8
L3 <- seq(h,120,0.1)
y3 <- f2(L2,h,a3,b)

plot(L3,y3,type='l',xlim=c(80,120),ylim=c(0,0.8),main='a=0.8')
mtext('Changing a in f2', side = 3, line = 0, outer = TRUE)
```

Through this parameter exploration we have become more familiar with the function $f_2$. Our understanding of the general model $f_2$ will enable us to better be able to determine specific functions, of the form of $f_2$, that have desired behaviors. Our parameter exploration has also provided us an opportunity to play with a become familiar with the concept of how selecting parameters identifies a specific model. We also see in our exploration that there are many specific models for each general form and some of the specific model have very different behavior when compared to each other.

To access the Rmd file used to create this html file, [use this link](https://byuistats.github.io/M119/file_share_kj/ExampleProject_Task2.Rmd). 
